"use strict";var App;App={loadedImgs:{},totalLoadedImgs:0,prevImgWrapW:100,prevImgWrapOW:118,prevImgWrapH:70,curSlideLeft:0,transitionEndEvent:"webkitTransitionEnd.trans otransitionend.trans                         oTransitionEnd.trans msTransitionEnd.trans                         transitionend.trans",init:function(){return $("#add-imgs .icon").click(App.addImgs),$("#show-options .icon").click(App.showOptions),$("#resize .icon").click(App.resize),$("#show-about .icon").click(App.showAbout),$("#toggle-preview").click(App.togglePreview),$(".menu .item:has(.submenu)").click(function(a){return a.stopPropagation()}),$(document).click(function(){return App.closeSubMenu($(".menu .item:has(.submenu).submenu-active"))}),$("#files").change(function(){return App.loadFiles(this.files)}),$(".preview").on("mouseenter",".img-wrap",function(){return $(this).addClass("hover")}),$(".preview").on("mouseleave",".img-wrap",function(){return $(this).removeClass("hover")}),$(".preview").on("click",".img-wrap",App.selectImg),$(".preview").on("click",".img-wrap .icon-cancel",App.removeImg),$("#preview-next").click(App.previewNext),$("#preview-back").click(App.previewBack),$('[name="img-type"]').change(function(){var a;return a=$(this).val(),"jpeg"===a?$("#jpeg-quality").removeAttr("disabled","").parents(".control-group").removeClass("disabled"):$("#jpeg-quality").attr("disabled","").val("").parents(".control-group").addClass("disabled")}),$('[name="resize-by"]').change(function(){var a,b;return b=$(this).val(),a=$("#"+b+"-controls"),a.show().siblings(".subcontrol-group").hide(),a.find("input").eq(0).focus(),"dimensions"===b?$("#aspect-ratio-hint").show():$("#aspect-ratio-hint").hide()})},addImgs:function(){return $("#files").click()},showOptions:function(){return App.openSubMenu($("#show-options"))},resize:function(){return App.showLoading(),setTimeout(function(){var a,b,c,d,e,f,g;return c={},f=$('[name="img-type"]:checked').val(),c.type=f,"jpeg"===f&&(b=$("#jpeg-quality").val()||100,c.quality=b/100),d=$('[name="resize-by"]:checked').val(),"scale"===d&&(e=$("#scale").val()||100,c.scale=e),"dimensions"===d&&(g=parseFloat($("#width").val())||100,a=parseFloat($("#height").val()),c.dimensions=[g,a]),App.resizeImgs(App.loadedImgs,c,function(a){var b,c;return b="png"===f?"png":"jpg",c=App.zipArrayBuffers(a,b),App.saveBlob(c,"resizedImages.zip"),App.hideLoading()})},5)},showAbout:function(){return App.openSubMenu($("#show-about"))},togglePreview:function(){return $(".preview").toggleClass("hidden")},selectImg:function(){var a;return a=$(this),a.siblings(".active").removeClass("active"),a.addClass("active"),$("#view").show().find("img").attr("src",a.find("img").attr("src"))},removeImg:function(){var a,b,c,d;return c=$("#preview-next"),b=$("#preview-back"),a=$(this).parents(".img-wrap"),a.hasClass("active")&&$("#view").hide(),d=a.data("unique-name"),delete App.loadedImgs[d],App.totalLoadedImgs--,a.remove(),$(".preview .slide-panel").width(App.totalLoadedImgs*App.prevImgWrapOW),c.is(":hidden")&&b.is(":visible")&&b.click(),App.curSlideLeft+(App.totalLoadedImgs-4)*App.prevImgWrapOW===0&&c.hide(),4===App.totalLoadedImgs&&(c.hide(),b.hide()),0===App.totalLoadedImgs&&($(".menu").addClass("no-imgs"),$(".preview").hide(),$("#start-adding-imgs").show()),!1},previewNext:function(){return $("#preview-back").show(),App.curSlideLeft=App.curSlideLeft-App.prevImgWrapOW,$(".preview .slide-panel").css("left",App.curSlideLeft+"px"),App.curSlideLeft+(App.totalLoadedImgs-4)*App.prevImgWrapOW===0?$(this).hide():void 0},previewBack:function(){return $("#preview-next").show(),App.curSlideLeft=App.curSlideLeft+App.prevImgWrapOW,$(".preview .slide-panel").css("left",App.curSlideLeft+"px"),0===App.curSlideLeft?$(this).hide():void 0},openSubMenu:function(a){return App.closeOtherSubMenus(a),a.on(App.transitionEndEvent,function(){return a.off(".trans").addClass("submenu-active")}),a.addClass("title-active")},closeSubMenu:function(a){var b;return b=a.find(".submenu"),b.on(App.transitionEndEvent,function(){return b.off(".trans"),a.removeClass("title-active")}),a.removeClass("submenu-active")},closeOtherSubMenus:function(a){var b;return b=$(".menu .item.title-active").not(a),b.each(function(){return App.closeSubMenu($(this))})},loadFiles:function(a){var b,c,d,e,f,g,h,i;for(e=a.length,f=0,e&&App.showLoading(),i=[],c=g=0,h=a.length;h>g;c=++g)b=a[c],d=b.name,i.push(function(a){var c;return c=new FileReader,c.onload=function(b){var c;return c=document.createElement("img"),c.onload=function(){return f++,0===App.totalLoadedImgs&&($("#start-adding-imgs").hide(),$("#view").show().find("img").attr("src",c.src),$(".menu").removeClass("no-imgs"),$(".preview").show()),f===e&&App.hideLoading(),App.loadImg(c,a)},c.src=b.target.result},c.readAsDataURL(b)}(d,c));return i},loadImg:function(a,b){var c,d,e;if(d=b.slice(0,b.indexOf(".")),e=d,App.loadedImgs.hasOwnProperty(d))for(c=1;;)if(e=d+"_"+c,c++,!App.loadedImgs.hasOwnProperty(e))break;return App.loadedImgs[e]=a,App.totalLoadedImgs++,App.addPreviewImg(a,b,e)},addPreviewImg:function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n;return m=a.width,f=a.height,j=0,i=0,e=m+" Ã— "+f,f>m||f/m>=App.prevImgWrapH/App.prevImgWrapW?(a.height=i=App.prevImgWrapH,j=App.prevImgWrapH*(m/f)):(a.width=j=App.prevImgWrapW,i=App.prevImgWrapW*(f/m)),n=Math.abs((j-App.prevImgWrapW)/2),g=Math.abs((i-App.prevImgWrapH)/2),h={"padding-left":n,"padding-right":n,"padding-top":g,"padding-bottom":g},$(a).css(h),d=$(".preview .thumbs .slide-panel"),k=d.width(),d.width(k+App.prevImgWrapOW),App.totalLoadedImgs>4&&$("#preview-next").show(),l="",1===App.totalLoadedImgs&&(l="active"),$('<div class="img-wrap '+l+'">            <div class="dimensions" title="'+e+'">'+e+'</div>            <div class="name" title=" '+b+'">'+b+'</div>            <div class="icon-cancel"></div>            </div>').append(a).data("unique-name",c).appendTo(d)},showLoading:function(){return $(".loading").css("display","table")},hideLoading:function(){return $(".loading").hide()},resizeImgs:function(a,b,c){var d,e,f,g,h,i,j;g=[],i=Object.keys(a).length,h=0,j=[];for(f in a)e=a[f],b.scale&&(b.dimensions=App.scale2Dimension([e.naturalWidth,e.naturalHeight],b.scale)),d=App.resizedImgCanvas(e,b.dimensions),j.push(function(a){return App.canvasToArrayBuffer(d,b.type,b.quality,function(b){return g[a]=b,h++,h===i?c(g):void 0})}(f));return j},scale2Dimension:function(a,b){return[a[0]*(b/100),a[1]*(b/100)]},resizedImgCanvas:function(a,b){var c,d,e,f;return c=document.createElement("canvas"),d=c.getContext("2d"),f=b[0],e=b[1],e||(e=f*(a.naturalHeight/a.naturalWidth)),c.width=f,c.height=e,d.drawImage(a,0,0,a.naturalWidth,a.naturalHeight,0,0,f,e),c},canvasToArrayBuffer:function(a,b,c,d){return a.toBlob(function(a){var b;return b=new FileReader,b.onload=function(a){return d(a.target.result)},b.readAsArrayBuffer(a)},"image/"+b,c)},zipArrayBuffers:function(a,b){var c,d,e;e=new JSZip;for(d in a)c=a[d],e.file(d+"."+b,c,{binary:!0});return e.generate({type:"blob"})},saveBlob:function(a,b){return saveAs(a,b)}};